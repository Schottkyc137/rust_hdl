# ยง3: Subprograms and packages

SubprogramDeclaration: !Sequence
  - node: SubprogramSpecification
  - token: SemiColon

SubprogramSpecification: !Choice
  - node: ProcedureSpecification
  - node: FunctionSpecification

ProcedureSpecification: !Sequence
  - keyword: Procedure
  - node: Designator
  - node: SubprogramHeader
  - node: ParameterList
    optional: true

FunctionSpecification: !Sequence
  - node: FunctionPurity
    optional: true
  - keyword: Function
  - node: Designator
  - node: SubprogramHeader
  - node: ParameterList
  - keyword: Return
  - node: TypeMark

ParameterList: !Sequence
  - keyword: Parameter
    optional: true
  - node: InterfaceList
    parenthesized: true

FunctionPurity: !Choice
  - keyword: Pure
  - keyword: Impure

SubprogramHeader: !Sequence
  - node: GenericClause
    optional: true
  - node: GenericMapAspect
    optional: true

SubprogramBody: !Sequence
  - node: SubprogramSpecification
  - keyword: Is
  - node: DeclarativePart
  - keyword: Begin
  - node: StatementPart
  - keyword: End
  - node: SubprogramKind
    optional: true
  - node: Designator
    optional: true
  - token: SemiColon

SubprogramKind: !Choice
  - keyword: Procedure
  - keyword: Function

SubprogramInstantiationDeclaration: !Sequence
  - node: SubprogramKind
  - token: Identifier
    name: name
  - keyword: Is
  - keyword: New
  - node: Name
  - node: Signature
    optional: true
  - node: GenericMapAspect
    optional: true
  - token: SemiColon

PackageDeclaration: !Sequence
  - keyword: Package
  - token: Identifier
    name: name
  - keyword: Is
  - node: PackageHeader
  - node: DeclarativePart
  - keyword: End
  - keyword: Package
    optional: true
    name: trailing_package
  - token: Identifier
    name: trailing_name
    optional: true
  - token: SemiColon

PackageHeader: !Sequence
  - node: GenericClause
    optional: true
  - node: GenericMapAspect
    optional: true
  - token: SemiColon
    optional: true

PackageBody: !Sequence
  - keyword: Package
  - keyword: Body
  - token: Identifier
    name: name
  - keyword: Is
  - node: DeclarativePart
  - keyword: End
  - keyword: Package
    optional: true
    name: trailing_package
  - keyword: Body
    optional: true
    name: trailing_body
  - token: Identifier
    name: trailing_name
    optional: true
  - token: SemiColon

PackageInstantiationDeclaration: !Sequence
  - keyword: Package
  - token: Identifier
    name: name
  - keyword: Is
  - keyword: New
  - node: Name
  - node: GenericMapAspect
    optional: true
  - token: SemiColon

Signature: !Sequence
  - token: LeftSquare
  - node: TypeMark
    repeated: True
    separator: Comma
  - keyword: Return
  - node: TypeMark
    name: return_type
  - token: RightSquare
